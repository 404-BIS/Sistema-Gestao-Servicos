<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}">
        <style type="text/css"> 
            .modal {
                display: none; 
                position: fixed; 
                z-index: 1; 
                padding-top: 100px;
                left: 0;
                top: 0;
                width: 100%; 
                height: 100%; 
                overflow: auto;
                background-color: rgb(0,0,0); 
                background-color: rgba(0,0,0,0.6); 
            }
            .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
        }

        .dropdown-content a:hover {background-color: #f1f1f1;}

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .dropdown{
            margin: 30px;
            list-style-type: none
        }

        .info-user{
            display: flex;   
            align-items: center;
            justify-content: space-between;
            margin-top:10px
        }

        .sequencia-botao button{
            margin-left: 10px;
            padding: 0 16px;
            height: 35px;
            border: none;
            border-radius: 10px;
            background-color: #009B22;
            color: #FCFCFC;
            font-size: 13px;    
        }
        </style>
        
    </head>
    <body>
        <header>
            <img src="../../static/images/Usuario.svg"> 
            <nav>
                <a class="minha-chamada" href="/adm"><img class="icon-chamada" src="../../static/images/Manutencao.svg"> Controle de usuários </a>
                <ul>
                    <li class="dropdown">
                        <a href="javascript:void(0)" class="dropbtn">Requisições do Sistema</a>
                        <div class="dropdown-content">
                            <a href="/adm/requisicoes">Todas as Requsições</a>
                            <a href="/adm/estatisticas">Estatisticas das requisições</a>
                        </div>
                    </li>
                </ul>
                <ul>
                    <li class="dropdown">
                        <a href="javascript:void(0)" class="dropbtn">Minhas Requisições</a>
                        <div class="dropdown-content">
                            <a href="/adm/solicitacao">Criar chamados </a>
                            <a href="/adm/menu">Minhas requisições</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>
    
        <main>
            <div class="bbb">
                <p class="req-aberta">Requisições Abertas  </p>
                <div class="filtro">
                    <p>Filtrar por:
                    <select>
                        <option value="1">Mais Recente</option>
                        <option value="2">Mais Antigo</option>
                        <option value="3">A a Z</option>
                        <option value="4">Z a A</option>
                    </select></p>
                </div>
            </div>
            {%  if leitoraberto == 0 or Values ==0 %}
                <div class="box-req">
                <p>Sem requisições abertas no momento</p>
                </div>
            {% endif %}
            {% for solicitacao in Details %}   
                {% if solicitacao[3] =="Aberta" and solicitacao[9] == conta[0] %}
                    <details>
                        <summary>
                            <p>{{solicitacao[1]}}</p><!--variavel titulo-->
                            {% if solicitacao[4] == 'Problemas de Hardware'%}
                                <img class="icon" src="../static/images/Hardware.png" alt="icon"> <!--variavel icon-->
                            {% elif solicitacao[4] == 'Problemas de Software'%}
                                <img class="icon" src="../static/images/Software.png" alt="icon">
                            {%else%}
                                <img class="icon" src="../static/images/Info.png" alt="icon">
                            {%endif%}
                        </summary>
                        <div class="conteudo">
                            <p>Tipo: <span>{{solicitacao[1]}}</span></p>
                            <p>Descrição: <span>{{solicitacao[2]}}</span></p>
                        </div>
                        <form action="/usuario/{{solicitacao.0}}" method='POST'>
                            <button class="botao-padrao" type="submit">Apagar</button>             
                        </form>  
                    </details>
                {% endif %}
            {% endfor %}
            <div class="bbb">
                <p class="req-fechada">Requisições Fechadas</p>
                <div class="filtro">
                    <p>Filtrar por:
                    <select>
                        <option value="1">Mais Recente</option>
                        <option value="2">Mais Antigo</option>
                        <option value="3">A a Z</option>
                        <option value="4">Z a A</option>
                    </select></p>
                </div>
            </div>
            {%  if leitorfechado == 0 or Values==0 %}
                <div class="box-req">
                <p>Sem requisições abertas no momento</p>
                </div>
            {%endif%}
            {% for solicitacao in Details %}   
                {% if solicitacao[3] =="Fechada" and solicitacao[9] == conta[0] %}
                <details>
                    <summary>
                        <p>{{solicitacao[1]}}</p><!--variavel titulo-->
                        {% if solicitacao[4] == 'Problemas de Hardware'%}
                            <img class="icon" src="../static/images/Hardware.png" alt="icon"> <!--variavel icon-->
                        {% elif solicitacao[4] == 'Problemas de Software'%}
                            <img class="icon" src="../static/images/Software.png" alt="icon">
                        {%else%}
                            <img class="icon" src="../static/images/Info.png" alt="icon">
                        {%endif%}
                    </summary>
                    <div class="conteudo">
                        <p>Tipo: <span>{{solicitacao[4]}}</span></p>
                        <p>{{solicitacao[8]}}</p>
                        <p>Descrição: <span>{{solicitacao[2]}}</span></p>
                    </div>
                    {%if solicitacao[10] != '1' and solicitacao[10] != '2' and solicitacao[10] != '3'and solicitacao[10] != '4' and solicitacao[10] != '5'%}
                    <div class="avaliar">
                        <p class="detalhes-fechamento"> Requisição Fechada por: <span> {{solicitacao[6]}} </span></p> 
                        
                        <button class="concluir btnconcluir" type="submit">Concluir</button>
                    </div>
                    {%endif%}
                    <div class="texto-fechamento">
                        <span> {{solicitacao[5]}}</span>    
                    </div>
                </details>
                <div id="concluir" class="modal">
                    <div class="icon-fechar"></div>
                    <form class="avaliacao" action="/avaliar/{{solicitacao.0}}" method="POST"> 
                            <div class="icon-fechar"></div>
                            <div class="header">
                                <b>Avaliação</b>
                                <!--<button><span class="material-icons close">close</span></button>-->
                            </div>
                            <div class="caras">           
                                <input name="pes" value="1" type="checkbox">
                                    <img src="../static/images/pessimo.png">
                                    <span>Péssimo</span>
                                 </input>
                                <input name="ruim" value="2" type="checkbox">
                                    <img src='../static/images/ruim.png'>
                                    <span>Ruim</span>
                                </input>
                                <input name="med" value="3" type="checkbox">
                                    <img src="../static/images/mediano.png">
                                    <span>Mediano</span>
                                </input>
                                <input name="bom" value="4" type="checkbox">
                                    <img src='../static/images/bom.png'>
                                    <span>Bom</span>
                                </input>
                                <input name="otimo" value="5"type="checkbox">
                                    <img src='../static/images/otimo.png'>
                                    <span>Ótimo</span>
                            </input>
                            </div>
                            <textarea placeholder="Descreva sua avaliação" name="avaliacao"></textarea>
                            <div class="submit">
                                <button >Avaliar</button>
                            </div>
                    </form>
                </div>
            {% endif %}
            {% endfor %}
            

            <p class="tipo-legenda">Tipos de Problemas</p>
            <div class="legenda">
                <div class="hardware">
                    <div>
                        <p class="categoria">Problemas de Hardware</p>
                        <p class="quant">Quantidade:{{cont_hardware}}</p> <!--variavel de quantidade-->
                    </div>    
                    <img class="icon" src="../../static/images/Hardware.png" alt="hardware">
                </div>   
    
                <div class="software">
                    <div>
                        <p class="categoria">Problemas de Software</p>
                        <p class="quant">Quantidade:{{cont_software}}</p> <!--variavel de quantidade-->
                    </div>    
                    <img class="icon" src="../../static/images/Software.png" alt="hardware">
                </div>  
    
                <div class="info">
                    <div>
                        <p class="categoria">Dúvidas/Esclarecimentos</p>
                        <p class="quant">Quantidade:{{cont_duv}}</p> <!--variavel de quantidade-->
                    </div>    
                    <img class="icon" src="../../static/images/Info.png" alt="hardware">
                </div>  
            </div>
        </main>
        <script>
            // var modalavaliar = document.getElementById("avaliar");
            var modalconcluir = document.getElementById("concluir");
            var btnsconcluir = document.getElementsByClassName("btnconcluir")[0];
            var fechar = document.getElementsByClassName("icon-fechar")[0];

            btnsconcluir.onclick = function() {
                console.log('oi')
                modalconcluir.style.display = "block";
            }

            fechar.onclick = function() {
                console.log('socorro')
                modalconcluir.style.display = "none";
            }

            window.onclick = function(event) {
              if (event.target == modalconcluir) {
                modalconcluir.style.display = "none";
              }
            }
        </script>
    </body>
</html>